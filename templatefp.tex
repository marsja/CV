\documentclass[$if(fontsize)$$fontsize$,$endif$$if(papersize)$$papersize$paper,$endif$$for(classoption)$$classoption$$sep$,$endfor$]{$documentclass$}
\usepackage{lscape}
\usepackage{adjustbox}
\usepackage{titling}
\usepackage{caption}
\usepackage{tabularx}
\usepackage{tikz}
\usepackage{xcolor}
\usepackage{fancyhdr}
\usepackage{lastpage}
\usepackage{titlesec}
\usepackage[scaled=.90]{helvet}% Helvetica, served as a model for arial

\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0.0pt}
\fancyfoot[CO,CE]{CV - Erik Marsja - Page \thepage \hspace{1pt} of \pageref{LastPage}}
\fancypagestyle{plain}{\pagestyle{fancy}}

$if(geometry)$
\usepackage[$for(geometry)$$geometry$$sep$,$endfor$]{geometry}
$endif$

% Font awesome
\usepackage{fontawesome}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[swedish]{babel}

% For tables

$if(tables)$
\usepackage{booktabs}
$endif$

% Tightlist

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}

% URLS
\usepackage[hidelinks]{hyperref}
\usepackage{float} % here for H placement parameter

% Appendix header style

\fancypagestyle{style2}{
\fancyhf{}
\fancyhead[C]{Appendix 1}
}


% For Changing the margins (Education)

\def\changemargin#1#2{\list{}{\rightmargin#2\leftmargin#1}\item[]}
\let\endchangemargin=\endlist 

%For displaying the table in landscape format
\usepackage[absolute]{textpos}

\fancypagestyle{lscape}{% 
\fancyhf{} % clear all header and footer fields 
\fancyfoot[LE]{%
\begin{textblock}{20}(1,5){\rotatebox{90}{\leftmark}}\end{textblock}
\begin{textblock}{1}(13,10.5){\rotatebox{90}{\thepage}}\end{textblock}}
\fancyfoot[LO] {%
\begin{textblock}{1}(13,10.5){\rotatebox{90}{\thepage}}\end{textblock}
\begin{textblock}{20}(1,13.25){\rotatebox{90}{\rightmark}}\end{textblock}}
\renewcommand{\headrulewidth}{0pt} 
\renewcommand{\footrulewidth}{0pt}}

\setlength{\TPHorizModule}{1cm}
\setlength{\TPVertModule}{1cm}

% Appendix
\fancypagestyle{style2}{
\fancyhf{}
\fancyhead[C]{Appendix 1}
\renewcommand{\headrulewidth}{1pt}
}



\newcommand\secbar {
    \tikz[baseline, trim left=3.2cm] 
    {
        \fill [white] (3cm,0.1ex) rectangle +(0.2cm,1.1ex);
        \draw [gray!95, fill=gray!80] (0cm,0.1ex) rectangle (3cm,1.1ex);        
    }
}
\newcommand\subsecbar {
    \tikz[baseline, trim left=0.15cm] 
    {
        \fill [white] (2cm,0.1ex) rectangle +(0.2cm,1.1ex);
        \fill [blue!40] (0cm,0.1ex) rectangle (2cm,1.1ex);      
    }
}

\newcommand\subsubsecbar {
    \tikz[baseline, trim left=0.15cm] 
    {
        \fill [white] (1cm,0.1ex) rectangle +(0.2cm,1.1ex);
        \fill [blue!40] (0cm,0.1ex) rectangle (2cm,1.1ex);      
    }
}

\titleformat{\section}{\large}{}{0cm}{\secbar}
\titleformat{\subsection}{\large}{}{0cm}{\normalfont\sffamily\Large\bfseries\subsecbar}
\titleformat{\subsubsection}{}{}{0cm}{\normalfont\sffamily\large\bfseries}

% No first line paragraph indent
\usepackage{parskip}
\usepackage{enumitem}



\newcolumntype{Y}{>{\centering\arraybackslash}X}

\begin{document}


\vspace{2 mm}


$body$

\end{document}